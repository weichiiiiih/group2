install.packages(c("ggplot2", "gcookbook"))
library(ggplot2)
library(gcookbook)

taipeimetro <- data.frame(
year = c(104,105,106,107,108,109,110,111),
value = c(716.575283,
738.974313,
745.298914,
764.804427,
788.970453,
695.540439,
530.912219,
587.017562
)
)

ggplot(taipeimetro, aes(x = year, y = value)) +
geom_line(color = "blue", size = 2) +
labs(x = "年份", y = "人數(百萬)", title = "總進站折線圖") +
scale_x_continuous(breaks = c(104,105,106,107, 108, 109,110,111), labels = c("104","105","106","107","108","109","110","111")
)

values <- c(716.575283,
788.970453
)

change_rate <- function(values) {
new_values <- values[-1]
old_values <- values[-length(values)]

rate <- (new_values - old_values) / old_values * 100

return(rate)
}

result <- change_rate(values)
print(result)

values2 <- c( 788.970453,
530.912219)
change_rate <- function(values) {
new_values <- values[-1]
old_values <- values[-length(values)]

rate <- (new_values - old_values) / old_values * 100

return(rate)
}

result2 <- change_rate(values2)
print(result2)

co108 <- data.frame(
X <- c( 788970453 , 32213290 , 28021574 , 26383018 ,22918425 , 15508892 ,15431724 , 14942869 , 14472026,
13048812 , 12774960 , 12768222 , 12557498 ,12529506, 11839165 , 11703409, 11599492 , 10960768,
10851408, 10810764 ,10752431 , 10584883 , 10497855 ,10070060 , 9975312 , 9588769 , 9456006,
9161345 , 9095877 ,9060748 , 8795910 , 8528563 , 8458027 ,8203502 , 8173487 , 8132062,
8074391 , 8058457 , 7940668 , 7802451 , 7697457 , 7573177 , 7084156 , 6731368 , 6697772,
6502146 , 6358823 , 6218328 , 6162698 , 6115163 , 6014623 , 5913923 , 5506382 , 5357695,
5337318 ,5216306 ,5167189 , 5160937 , 5142984 , 5136693 ,5047217 , 4975425 , 4930890,
4924815, 4910743 , 4859647 , 4783943 , 4726784 , 4518600 , 4472613 , 4379442 , 4370474,
4329197 , 4323933 , 4280696 ,4096043 , 4028843 ,3950474 , 3813387 , 3706781 , 3705644,
3687794 , 3636745 , 3569929 , 3540614 , 3496991 , 3413429 , 3362609 , 3352913 , 3342608,
3335696 , 3335302 , 3320081 , 3128164 , 3093174 , 2976268 , 2953953 , 2928222 , 2676232,
2674797 , 2533464 , 2503141 ,2425455 , 2174568 , 2134235 , 2045650 ,1966180 , 1918325,
1808454 , 1624626 ,1594225 , 1505355 ,1313968 , 1274941 , 1175566 , 1137795 , 1111153,
920476),

Y <- c(788970453, 35184207, 28297655 , 23497857 , 22834584 , 16646188 , 15207923 , 14379777 , 13571505 , 13481169 , 13418573 , 13307828, 13063997 , 12112395,
11789483, 11678951 , 11242912, 11240924 , 10831768 , 10683673 , 10670179, 10584636 , 10506112, 10372629 , 9796328 , 9752318 , 9646413 , 9346404,
9089934 , 8940430 , 8703301 , 8668814 , 8595742 , 8593000, 8573283 , 8516877, 8488097 , 8093456 , 8043072 , 7777414 , 7754299 , 7385181,
7098530 , 6946372 , 6867475 , 6717227 , 6645947 , 6221183 , 6219435 , 5990333 , 5982851 , 5926291 , 5497713 , 5450194 , 5398594 , 5287254,
5085322 , 5082422 , 5048206 , 5010919 , 4996530 , 4955870 , 4860405 , 4731585, 4574981, 4557783 , 4437983 , 4437086 , 4409363 , 4401348,
4334631 , 4329358 , 4328408 , 4325451 , 4315094 , 4310013, 4209450 , 4075882 , 4072011 , 4009890 , 3625554 , 3541385 , 3529864 , 3503817,
3480557 , 3478480 , 3445594 , 3367772 , 3278281 , 3235227 , 3195226 , 3045300, 3027637 , 2976175 , 2936342 , 2900911 , 2856901 , 2757323,
2631584 , 2545414 , 2505663 , 2494589 , 2412453 , 2302274, 2044026 , 1910951 , 1767259 , 1727473 , 1574373 , 1561222 , 1560068 , 1518282,
1306497 , 1238799 , 1223764 , 1136776 , 1063193 , 744769)

)

cor108 <- cor(co108$X....c.788970453..32213290..28021574..26383018..22918425..15508892.., co108$Y....c.788970453..35184207..28297655..23497857..22834584..16646188..)

print(paste("相關係數",cor108))

data5$...1 |>
factor() ->　data5$mrtstop
levels(data5$mrtstop)[c(1,4, 3, 2)] <- c("a","a","b", "b")
data5$isbannan <- logical(120)
data5$isbannan[c(66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87) = TRUE]
V10data <- transform(data,
Group = case_when(
row_number() %in%c(66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87) ~ "板南線",
row_number() %in% c(44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,88,89,90,91,92,113) ~ "淡水信義線",
row_number() %in% c(100,101,102,103,104,105,106,107,108,109,110,111,112,114,115,116,117,118,119,120) ~ "中和新蘆線",
row_number() %in% c(28,29,30,31,32,33,34,35,36,37,38,39,93,94,95,96,97,98,99) ~ "松山新店線",
row_number() %in% c(4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30) ~ "文湖線"
))
